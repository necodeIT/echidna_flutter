name: Generate Documentation

on:
  push:
    branches:
      - main
    paths-ignore:
      - 'doc/**'

jobs:
  generate-docs:
    name: 📖 Generate Documentation
    runs-on: ubuntu-latest

    steps:
    - name: 📂 Checkout code
      uses: actions/checkout@v3

    - name: 🛠️ Set up Dart
      uses: dart-lang/setup-dart@v1
      with:
        sdk: stable

    - name: 📦 Install dependencies
      run: dart pub get

    - name: 📝 Generate documentation
      run: dart doc

    - name: 🚀 Commit and Push Docs
      run: |
        git config --global user.name "github-actions[bot]"
        git config --global user.email "github-actions[bot]@users.noreply.github.com"
        git add doc/
        git diff --cached --quiet || git commit -m "docs: generate documentation for ${{github.sha}}"
        git push
